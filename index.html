<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>你系乜水啊</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="张大伟">
<meta property="og:type" content="website">
<meta property="og:title" content="你系乜水啊">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="你系乜水啊">
<meta property="og:description" content="张大伟">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="你系乜水啊">
<meta name="twitter:description" content="张大伟">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="post-win7下nginx+php+MySQL环境搭建" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/23/win7下nginx+php+MySQL环境搭建/">win7下nginx+php+MySQL环境搭建</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/11/23/win7下nginx+php+MySQL环境搭建/" class="article-date">
  <time datetime="2015-11-22T16:26:48.702Z" itemprop="datePublished">2015-11-23</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-_材料">1. 材料</h2><ul>
<li><a href="http://windows.php.net/download/" target="_blank" rel="external">php-5.4.45-nts-Win32-VC9-x86</a></li>
<li><a href="http://dev.mysql.com/downloads/mysql/" target="_blank" rel="external">mysql-5.5.46-win32</a></li>
<li><a href="http://nginx.org/en/download.html" target="_blank" rel="external">nginx-1.8.0</a></li>
<li><a href="http://redmine.lighttpd.net/attachments/660/RunHiddenConsole.zip" target="_blank" rel="external">RunHiddenConsole</a></li>
</ul>
<h2 id="2-_安装">2. 安装</h2><h3 id="2-1_nginx配置">2.1 nginx配置</h3><p>在D盘下建立名为server的目录 D:\server<br>解压nginx-1.8.0.zip至D:\server\nginx-1.8.0<br>找到下面的nginx.exe，在命令行下运行nginx.exe<br>在浏览中键入：<a href="http://127.0.0.1" target="_blank" rel="external">http://127.0.0.1</a>, 看到下图所示证明nginx正常工作。</p>
<p><img src="/img/welcome to nginx.png" alt="figure1"></p>
<p>配置网站根目录<br>在D:\server下建立www目录<br>在www目录下新建一个index.html文件，其内容如下：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;html&gt;</span></span><br><span class="line">    <span class="tag">&lt;head&gt;</span></span><br><span class="line">    <span class="tag">&lt;/head&gt;</span></span><br><span class="line">    <span class="tag">&lt;body&gt;</span></span><br><span class="line">        <span class="keyword">test</span> is ok !  </span><br><span class="line">    <span class="tag">&lt;/body&gt;</span></span><br><span class="line"><span class="tag">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>修改D:\server\nginx-1.8.0\conf\nginx.conf<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    <span class="preprocessor">#root   html;</span></span><br><span class="line">    root D:\sever\www; <span class="preprocessor">#正反斜杠好像都可以</span></span><br><span class="line">    <span class="keyword">index</span>  <span class="keyword">index</span>.html <span class="keyword">index</span>.htm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>重新加载nginx配置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx <span class="operator">-s</span> reload</span><br></pre></td></tr></table></figure></p>
<p>在浏览中键入：<a href="http://127.0.0.1" target="_blank" rel="external">http://127.0.0.1</a>, 看到 test is ok !说明工作正常</p>
<p>停止nginx：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx <span class="operator">-s</span> stop</span><br></pre></td></tr></table></figure></p>
<h3 id="2-2_php配置">2.2 php配置</h3><p>解压php-5.4.45-nts-Win32-VC9-x86.zip 到D:\server\php-5.4.45-nts-Win32-VC9-x86<br>重命名php目录下的php.ini-development 为php.ini</p>
<p>启动php-cgi：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">php-cgi</span><span class="class">.exe</span> <span class="tag">-b</span> 127<span class="class">.0</span><span class="class">.0</span><span class="class">.1</span><span class="pseudo">:9000</span> <span class="tag">-c</span> <span class="tag">php</span><span class="class">.ini</span></span><br></pre></td></tr></table></figure></p>
<p>使用命令<br><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -<span class="literal">a</span></span><br></pre></td></tr></table></figure></p>
<p>出现下列信息说明php-cgi启动成功<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TCP    <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">9000</span>         XXX-PC:<span class="number">0</span>        LISTENING</span><br></pre></td></tr></table></figure></p>
<h3 id="2-3_nginx+php">2.3 nginx+php</h3><p>使nginx能将php请求交给php处理<br>修改nginx配置文件：<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">location</span> <span class="regexp">~ \.php$</span> &#123;</span><br><span class="line">    <span class="comment">#root          html;</span></span><br><span class="line">    <span class="title">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">    <span class="title">fastcgi_index</span>  index.php;</span><br><span class="line">    <span class="title">fastcgi_param</span>  SCRIPT_FILENAME  D:\server\www<span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">    <span class="title">include</span>        fastcgi_params;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>重新加载配置文件</p>
<p>在www目录下新建index.php,文件内容如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="preprocessor">&lt;?php</span>  </span><br><span class="line"><span class="keyword">echo</span> phpinfo();</span><br><span class="line"><span class="preprocessor">?&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>在浏览器中打开<a href="http://127.0.0.1/index.php" target="_blank" rel="external">http://127.0.0.1/index.php</a><br>出现php环境信息页面说明配置成功。</p>
<h3 id="2-4_MySQL">2.4 MySQL</h3><ol>
<li>将mysql-5.5.46-win32.zip解压到D:\server\mysql-5.5.46-win32</li>
<li><p>在D:\server\mysql-5.5.46-win32新建个my.ini，并复制下面的代码保存就ok了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[mysql]</span><br><span class="line"><span class="preprocessor"># 设置mysql客户端默认字符集</span></span><br><span class="line"><span class="keyword">default</span>-character-<span class="built_in">set</span>=utf8 </span><br><span class="line">[mysqld]</span><br><span class="line"><span class="preprocessor">#设置<span class="number">3306</span>端口</span></span><br><span class="line">port = <span class="number">3306</span> </span><br><span class="line"><span class="preprocessor"># 设置mysql的安装目录</span></span><br><span class="line">basedir=D:\server\mysql-<span class="number">5.5</span><span class="number">.46</span>-win32</span><br><span class="line"><span class="preprocessor"># 设置mysql数据库的数据的存放目录</span></span><br><span class="line">datadir=D:\server\mysql-<span class="number">5.5</span><span class="number">.46</span>-win32\data</span><br><span class="line"><span class="preprocessor"># 允许最大连接数</span></span><br><span class="line">max_connections=<span class="number">200</span></span><br><span class="line"><span class="preprocessor"># 服务端使用的字符集默认为<span class="number">8</span>比特编码的latin1字符集</span></span><br><span class="line">character-<span class="built_in">set</span>-server=utf8</span><br><span class="line"><span class="preprocessor"># 创建新表时将使用的默认存储引擎</span></span><br><span class="line"><span class="keyword">default</span>-storage-engine=INNODB</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装mysql服务。以管理员身份打开cmd窗口后，再输入mysqld install回车运行即可。</p>
</li>
<li>打开MySQL。还是将目录切换到D:\server\mysql-5.5.46-win32\bin，输入mysql -u root -p ,默认是没有密码的，回车进入。<em>设置密码的方法：mysqladmin -u root -p password 密码。</em>退出<strong>exit</strong>就行。记住直接关闭cmd窗口是没有退出的，要输入exit才会退出。</li>
<li>启动mysql：<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:<span class="command">\server</span><span class="command">\mysql</span>-5.5.46-win32<span class="command">\bin</span>&gt;mysqld</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>用netstat -a 命令查看，出现如下信息，说明mysql启动成功。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TCP    <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">3306</span>           XXX-PC:<span class="number">0</span>        LISTENING</span><br></pre></td></tr></table></figure></p>
<h3 id="2-5_php+MySQL">2.5 php+MySQL</h3><p>打开php.ini<br>找到以下两行：<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; extension_dir = "ext"  </span></span><br><span class="line">………………  </span><br><span class="line"><span class="comment">; extension=php_mysql.dll</span></span><br></pre></td></tr></table></figure></p>
<p>分别将这两行前面的分号去掉，重启php-cgi。使修改后的配置生效。</p>
<p>在www目录下新建mysql_test.php，内容如下：<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line"><span class="variable">$con</span> = mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">""</span>);  </span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$con</span>)&#123;  </span><br><span class="line">  die(<span class="string">'Could not connect: '</span> . mysql_error());  </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">  echo <span class="string">'Database connected successfully'</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">mysql_close(<span class="variable">$con</span>);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>打开<a href="http://127.0.0.1/mysql_test.php" target="_blank" rel="external">http://127.0.0.1/mysql_test.php</a><br>显示如下：<br>Database connected successfully<br>说明php已经支持mysql</p>
<h3 id="2-6_一键启动所有服务">2.6 一键启动所有服务</h3><p>这两个脚本分别完成所有服务的启动与关闭。<br>首先将RunHiddenConsole.exe复制到D:\server\nginx-1.2.5下</p>
<p>在D:\server下新建一个名为start_all_services.bat的批处理文件，此文件内容如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> starting php-cgi...  </span><br><span class="line"><span class="built_in">cd</span> /d D:\server\php-<span class="number">5.4</span>.<span class="number">45</span>-nts-W<span class="keyword">in</span>32-VC9-x86</span><br><span class="line">RunHiddenConsole.exe  php-cgi.exe -b <span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">9000</span> -c php.ini</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> starting nginx...</span><br><span class="line"><span class="built_in">cd</span> ../</span><br><span class="line"><span class="built_in">cd</span> nginx-<span class="number">1.8</span>.<span class="number">0</span></span><br><span class="line">RunHiddenConsole.exe nginx</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> starting mysql...</span><br><span class="line"><span class="built_in">cd</span> ../</span><br><span class="line"><span class="built_in">cd</span> mysql-<span class="number">5.5</span>.<span class="number">46</span>-win32\bin</span><br><span class="line">mysqld</span><br><span class="line"></span><br><span class="line">PAUSE</span><br></pre></td></tr></table></figure></p>
<p>在D:\server下新建一个名为stop_all_services.bat的批处理文件，此文件内容如下：<br><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> stopping nginx...</span><br><span class="line"><span class="winutils">taskkill</span> /F /IM nginx.exe &gt; <span class="stream">nul</span></span><br><span class="line"><span class="keyword">echo</span> stopping php-cgi...</span><br><span class="line"><span class="winutils">taskkill</span> /F /IM php-cgi.exe &gt; <span class="stream">nul</span></span><br><span class="line"><span class="keyword">echo</span> stopping mysql...</span><br><span class="line"><span class="winutils">taskkill</span> /F /IM mysqld.exe &gt; <span class="stream">nul</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PAUSE</span></span><br></pre></td></tr></table></figure></p>
<p>需要启动只需双击start_all_services.bat<br>需要关闭只需双击stop_all_services.bat</p>

      
    </div>
    
    
  </div>
  
</article>


    </section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 张大伟&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>
  </div>
</body>
</html>